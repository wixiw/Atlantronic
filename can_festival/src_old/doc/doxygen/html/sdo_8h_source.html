<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CanFestival: include/sdo.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>include/sdo.h</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">This file is part of CanFestival, a library implementing CanOpen Stack.</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">Copyright (C): Edouard TISSERANT and Francis DUPIN</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">See COPYING file for copyrights details.</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">This library is free software; you can redistribute it and/or</span>
<a name="l00009"></a>00009 <span class="comment">modify it under the terms of the GNU Lesser General Public</span>
<a name="l00010"></a>00010 <span class="comment">License as published by the Free Software Foundation; either</span>
<a name="l00011"></a>00011 <span class="comment">version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">This library is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00016"></a>00016 <span class="comment">Lesser General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"></span>
<a name="l00018"></a>00018 <span class="comment">You should have received a copy of the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment">License along with this library; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment">Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00021"></a>00021 <span class="comment">*/</span>
<a name="l00022"></a>00022 
<a name="l00034"></a>00034 <span class="preprocessor">#ifndef __sdo_h__</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#define __sdo_h__</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="keyword">struct </span>struct_s_transfer;
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;timer.h&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="keyword">typedef</span> void (*SDOCallback_t)(<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId);
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">/* The Transfer structure</span>
<a name="l00044"></a>00044 <span class="comment">Used to store the different segments of</span>
<a name="l00045"></a>00045 <span class="comment"> - a SDO received before writing in the dictionary</span>
<a name="l00046"></a>00046 <span class="comment"> - the reading of the dictionary to put on a SDO to transmit</span>
<a name="l00047"></a>00047 <span class="comment">*/</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keyword">struct </span>struct_s_transfer {
<a name="l00050"></a>00050   UNS8           nodeId;     
<a name="l00052"></a>00052   UNS8           whoami;     
<a name="l00053"></a>00053   UNS8           state;      
<a name="l00054"></a>00054   UNS8           toggle;        
<a name="l00055"></a>00055   UNS32          abortCode;  
<a name="l00058"></a>00058   UNS16          index;
<a name="l00059"></a>00059   UNS8           subIndex;
<a name="l00060"></a>00060   UNS32          count;      
<a name="l00061"></a>00061   UNS32          offset;     
<a name="l00067"></a>00067   UNS8           data [SDO_MAX_LENGTH_TRANSFERT];
<a name="l00068"></a>00068   UNS8           dataType;   
<a name="l00072"></a>00072   TIMER_HANDLE   timer;      
<a name="l00078"></a>00078   SDOCallback_t Callback;   
<a name="l00079"></a>00079 };
<a name="l00080"></a>00080 <span class="keyword">typedef</span> <span class="keyword">struct </span>struct_s_transfer s_transfer;
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="preprocessor">#include &quot;data.h&quot;</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="keyword">struct </span>BODY{
<a name="l00087"></a>00087     UNS8 data[8]; 
<a name="l00088"></a>00088 };
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">/* The SDO structure ...*/</span>
<a name="l00091"></a>00091 <span class="keyword">struct </span>struct_s_SDO {
<a name="l00092"></a>00092   UNS8 nodeId;          
<a name="l00093"></a>00093   <span class="keyword">struct </span>BODY body;
<a name="l00094"></a>00094 };
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="keyword">typedef</span> <span class="keyword">struct </span>struct_s_SDO s_SDO;
<a name="l00098"></a>00098 
<a name="l00105"></a>00105 <span class="keywordtype">void</span> <a class="code" href="sdo_8c.html#a9309025e29b59e09026abcd3b45a5b61" title="Reset of a SDO exchange on timeout. Send a SDO abort.">SDOTimeoutAlarm</a>(<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS32 <span class="keywordtype">id</span>);
<a name="l00106"></a>00106 
<a name="l00111"></a>00111 <span class="keywordtype">void</span> <a class="code" href="sdo_8c.html#a1f4f07eccc4890a11ccf4f632da7740b" title="Reset all SDO buffers.">resetSDO</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00120"></a>00120 UNS32 <a class="code" href="sdo_8c.html#a2eb5309dca3a7363da5e5e7230b85d58" title="Copy the data received from the SDO line transfert to the object dictionary.">SDOlineToObjdict</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line);
<a name="l00121"></a>00121 
<a name="l00128"></a>00128 UNS32 <a class="code" href="sdo_8c.html#a29427a80fd1aeabff30bf0602fbc220f" title="Copy the data from the object dictionary to the SDO line for a network transfert.">objdictToSDOline</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line);
<a name="l00129"></a>00129 
<a name="l00138"></a>00138 UNS8 <a class="code" href="sdo_8c.html#a2b662491084d03f3ad43d280a45ef23e" title="Copy data from an existant line in the argument &amp;quot;* data&amp;quot;.">lineToSDO</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line, UNS32 nbBytes, UNS8 * data);
<a name="l00139"></a>00139 
<a name="l00148"></a>00148 UNS8 <a class="code" href="sdo_8c.html#a5efdbb02d210aad29c6d162600d3ae55" title="Add data to an existant line.">SDOtoLine</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line, UNS32 nbBytes, UNS8 * data);
<a name="l00149"></a>00149 
<a name="l00165"></a>00165 UNS8 <a class="code" href="sdo_8c.html#a2019db2a4d17e6d29c055cbae173e2b9" title="Called when an internal SDO abort occurs. Release the line * Only if server * If client, the line must be released manually in the core application. The reason of that is to permit the program to read the transfers structure before its reset, because many informations are stored on it : index, subindex, data received or trasmited, ... In all cases, sends a SDO abort.">failedSDO</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS8 whoami, UNS16 index, UNS8 subIndex, UNS32 abortCode);
<a name="l00166"></a>00166 
<a name="l00172"></a>00172 <span class="keywordtype">void</span> <a class="code" href="sdo_8c.html#a42d33be015d4c4c83c73f1f0e588f481" title="Reset an unused line.">resetSDOline</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line);
<a name="l00173"></a>00173 
<a name="l00184"></a>00184 UNS8 <a class="code" href="sdo_8c.html#ab9c873a15f55b29112b5527a6cc6898d" title="Initialize some fields of the structure.">initSDOline</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line, UNS8 nodeId, UNS16 index, UNS8 subIndex, UNS8 state);
<a name="l00185"></a>00185 
<a name="l00196"></a>00196 UNS8 <a class="code" href="sdo_8c.html#a58d1f9691977617601beb9e5b4123252" title="Search for an unused line in the transfers array to store a new SDO. ie a line which value of the fie...">getSDOfreeLine</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 whoami, UNS8 *line);
<a name="l00197"></a>00197 
<a name="l00207"></a>00207 UNS8 <a class="code" href="sdo_8c.html#abb0c376b048ab2c6e0524b135b62376f" title="Search for the line, in the transfers array, which contains the beginning of the reception of a fragm...">getSDOlineOnUse</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS8 whoami, UNS8 *line);
<a name="l00208"></a>00208 
<a name="l00215"></a>00215 UNS8 <a class="code" href="sdo_8c.html#a555a772d3a88a29c495f33513f8b2d58" title="Close a transmission.">closeSDOtransfer</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS8 whoami);
<a name="l00216"></a>00216 
<a name="l00224"></a>00224 UNS8 <a class="code" href="sdo_8c.html#a7654021041675c1389fd2d1b590ff7cb" title="Bytes in the line structure which must be transmited (or received).">getSDOlineRestBytes</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line, UNS32 * nbBytes);
<a name="l00225"></a>00225 
<a name="l00233"></a>00233 UNS8 <a class="code" href="sdo_8c.html#a7ca56a650c5daaa24c89370f3b3d7bb0" title="Store in the line structure the nb of bytes which must be transmited (or received).">setSDOlineRestBytes</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 line, UNS32 nbBytes);
<a name="l00234"></a>00234 
<a name="l00242"></a>00242 UNS8 <a class="code" href="sdo_8c.html#ac6b5d7d1439d537da992a96644a1ca5d" title="Transmit a SDO frame on the bus bus_id.">sendSDO</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 whoami, s_SDO sdo);
<a name="l00243"></a>00243 
<a name="l00258"></a>00258 UNS8 <a class="code" href="sdo_8c.html#abb85c47a1a6c3774f87b685b7d493e1d" title="Transmit a SDO error to the client. The reasons may be : Read/Write to a undefined object Read/Write ...">sendSDOabort</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 whoami, UNS8 nodeId, UNS16 index, UNS8 subIndex, UNS32 abortCode);
<a name="l00259"></a>00259 
<a name="l00270"></a>00270 UNS8 <a class="code" href="sdo_8c.html#a2a93a7c780472b1d8666d89aa270f661" title="Treat a SDO frame reception call the function sendSDO.">proceedSDO</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, <a class="code" href="structMessage.html" title="The CAN message structure.">Message</a> *m);
<a name="l00271"></a>00271 
<a name="l00287"></a>00287 UNS8 <a class="code" href="group__sdo.html#ga5b1848530ec78cf9c297747df09e1c47" title="Used to send a SDO request frame to write the data at the index and subIndex indicated.">writeNetworkDict</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS16 index,
<a name="l00288"></a>00288                        UNS8 subIndex, UNS32 count, UNS8 dataType, <span class="keywordtype">void</span> *data);
<a name="l00289"></a>00289 
<a name="l00308"></a>00308 UNS8 <a class="code" href="group__sdo.html#ga4213ba5834ca7aa62c425e557d80e04f" title="Used to send a SDO request frame to write in a distant node dictionnary.">writeNetworkDictCallBack</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS16 index,
<a name="l00309"></a>00309                        UNS8 subIndex, UNS32 count, UNS8 dataType, <span class="keywordtype">void</span> *data, SDOCallback_t Callback);
<a name="l00310"></a>00310 
<a name="l00332"></a>00332 UNS8 <a class="code" href="group__sdo.html#ga3588b1278534b75148c31ed473406c77" title="Used to send a SDO request frame to write in a distant node dictionnary.">writeNetworkDictCallBackAI</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS16 index,
<a name="l00333"></a>00333                        UNS8 subIndex, UNS32 count, UNS8 dataType, <span class="keywordtype">void</span> *data, SDOCallback_t Callback, UNS8 endianize);
<a name="l00334"></a>00334 
<a name="l00348"></a>00348 UNS8 <a class="code" href="group__sdo.html#ga0e102a0835e4115920cd406e80a8d135" title="Used to send a SDO request frame to read.">readNetworkDict</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS16 index, UNS8 subIndex, UNS8 dataType);
<a name="l00349"></a>00349 
<a name="l00366"></a>00366 UNS8 <a class="code" href="group__sdo.html#ga542a5cdd20c00aa130a39fe68295e769" title="Used to send a SDO request frame to read in a distant node dictionnary.">readNetworkDictCallback</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS16 index, UNS8 subIndex, UNS8 dataType, SDOCallback_t Callback);
<a name="l00367"></a>00367 
<a name="l00384"></a>00384 UNS8 <a class="code" href="group__sdo.html#ga5fe9abeafde31c9c8bf7d468c1dcb6c9" title="Used to send a SDO request frame to read in a distant node dictionnary.">readNetworkDictCallbackAI</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS16 index, UNS8 subIndex, UNS8 dataType, SDOCallback_t Callback);
<a name="l00385"></a>00385 
<a name="l00412"></a>00412 UNS8 <a class="code" href="group__sdo.html#gab8a362443447b15446e516130ececfe4" title="Use this function after calling readNetworkDict to get the result.">getReadResultNetworkDict</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, <span class="keywordtype">void</span>* data, UNS32 *size, UNS32 * abortCode);
<a name="l00413"></a>00413 
<a name="l00440"></a>00440 UNS8 <a class="code" href="group__sdo.html#ga8671e306873f19362c60bb50ab930d1d" title="Use this function after calling writeNetworkDict function to get the result of the write...">getWriteResultNetworkDict</a> (<a class="code" href="structstruct__CO__Data.html" title="This structure contains all necessary informations to define a CANOpen node.">CO_Data</a>* d, UNS8 nodeId, UNS32 * abortCode);
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Feb 5 2011 14:13:00 for CanFestival by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
